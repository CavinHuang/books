
# 基础篇 2-微信小游戏开放能力
---

# 基础篇2：微信小游戏开放能力

小游戏的开放能力决定了我们可以在游戏设计中实现什么样的功能。在本节的内容中，将为大家介绍微信小游戏的几个重要能力，并且谈一谈基于这些能力，我们能如何去设计小游戏的玩法。

## 1\. 开放能力

目前，小游戏共开放了 30 多项能力，包括基础能力、社交开放能力、设备能力、代码包管理能力等。详细能力如下图所示：

![开放能力](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/9/13/165d34527647ad4a~tplv-t2oaga2asx-image.image)

接下来介绍其中几个比较重要的能力。

### 文件系统

文件系统是小程序（包括小游戏）提供的一套以小程序和用户维度隔离的存储及管理接口，所有文件系统的管理操作通过 [`FileSystemManager`](https://developers.weixin.qq.com/minigame/dev/document/file/FileSystemManager.html) 来调用。

文件主要分为两大类：代码包文件和本地文件（上限 50M）。代码包文件适用于放置首次加载时需要的文件，对于内容较大或需要动态替换的文件，可在小游戏启动之后再用下载接口下载到本地。本地文件是通过调用接口本地生成，或通过网络下载后存储到本地的文件，包括本地临时文件、本地缓存文件和本地用户文件。

### 分包加载

分包加载是在小游戏推出了一段时间后才扩展的功能，目的是满足开发者对于扩大包大小的需求，以实现更加丰富的游戏玩法。分包加载，即把游戏内容按一定规则拆分成几个包，首次启动时先下载必要的包，即“主包”，在主包内通过调用 [`wx.loadSubpackage()`](https://developers.weixin.qq.com/minigame/dev/document/subpackages/wx.loadSubpackage.html) 来触发其它分包的下载。

> 单个分包/主包大小不能超过 4M（所有分包大小不超过 8M）。

### 关系链数据

关系链数据功能丰富了小游戏社交的玩法。微信用户的关系链数据包括两个部分：一个是所有玩过该游戏的好友的游戏数据；另一个是某个群里玩过该游戏的用户的游戏数据。 游戏数据可以通过 [`wx.setUserCloudStorage()`](https://developers.weixin.qq.com/minigame/dev/document/open-api/data/wx.setUserCloudStorage.html) 或后台 API 写入的游戏业务数据，例如用户的段位、胜率等。只有被托管过数据的用户，才会被视为“玩过”该小游戏。

### 转发

[转发功能](https://developers.weixin.qq.com/minigame/dev/tutorial/open-ability/share.html)让用户在使用小游戏的过程中，可以转发消息给其他用户或群聊。转发包括被动转发，即用户点击右上角菜单中的“转发”选项后触发转发时间；还有主动转发，即在游戏内调用 [`wx.shareAppMessage()`](https://developers.weixin.qq.com/minigame/dev/document/share/wx.shareAppMessage.html)接口调起转发界面。调用转发时可配置 query 参数来实现场景区分。

### 关联跳转

目前，小游戏已经开放了跳转的能力，通过 [`wx.navigateToMiniProgram()`](https://developers.weixin.qq.com/minigame/dev/api/open-api/miniprogram-navigate/wx.navigateToMiniProgram.html) 接口可实现小程序与小游戏、小游戏与小游戏之间互相跳转。关联了同一个公众号，就算小程序与小游戏非同主体也能进行跳转。这给小游戏带来了更多异业合作的空间。

### 防沉迷

作为游戏类目，微信小游戏人性化地提供了防沉迷能力。开发者可通过 [`wx.checkIsUserAdvisedToRest()`](https://developers.weixin.qq.com/minigame/dev/document/open-api/anti-addiction/wx.checkIsUserAdvisedToRest.html) 判断用户的在线时长是否超过健康值，并可建议用户适度休息，合理分配游戏时间，以防止用户过度沉迷游戏。

### 内容安全接口

内容安全接口的功能总结起来就是：鉴黄、认脸、看字。通过 [`imgSecCheck`](https://developers.weixin.qq.com/minigame/dev/document/open-api/sec-check/imgSecCheck.html)、[`msgSecCheck`](https://developers.weixin.qq.com/minigame/dev/document/open-api/sec-check/msgSecCheck.html)接口，能够精准快速地校验小程序的文本、图片内容是否含有淫秽色情、涉违法犯罪、涉政有害等内容，抵御不良信息混入，维护小程序内容健康。

## 2\. 玩法探索

小游戏不仅提供了许多基础能力，更提供了微信特有的能力，这为小游戏的玩法设计带来了更多的可能。

依托于微信平台的小游戏，最核心的玩法就在于社交。前文提到，微信提供了关系链的能力，利用关系链，可以获取同玩好友的游戏数据及所在群同玩好友的数据，因此我们可以在小游戏中设计好友排行榜和群排行榜的玩法。

![排行榜](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/9/13/165d345276a413c3~tplv-t2oaga2asx-image.image)

除了排行榜，关系链获取同玩好友，还可以设计超越的玩法。在游戏过程中，用户达到某一个分数或等级，即可显示已超越的某位好友的游戏数据，从而满足玩家的成就感。

![超越](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/9/13/165d3452769b4f64~tplv-t2oaga2asx-image.image)

有了超越玩法之后，还可以通过分享转发能力实现炫耀或者挑战。转发出来的消息卡片中，可以自定义标题，也可以将 Canvas 内容作为转发的图片，从而将玩家当前的游戏分数或超越人数等信息作为消息进行转发，以达到炫耀的目的，刺激其他玩家加入。

![转发分享](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/9/13/165d345276917ba9~tplv-t2oaga2asx-image.image)

分享转发的另一个玩法，可以用来实现场景的切片分发。分享转发时可配置不同的参数，可以将用户在不同场景下的转发操作配置不同的场景值，如求助好友、邀请挑战、分享群排行等。其他用户通过消息卡片进入游戏，可触达不同的场景页，从而实现场景的切片分发。

![切片分发](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/9/13/165d3452768c793b~tplv-t2oaga2asx-image.image)

微信小游戏里可以很好的完成单机游戏，但基于平台的社交性，多人对战游戏也是一个很好的切入点。虽然没有像 QQ 玩一玩一样提供房间匹配能力，但这对于开发者来说开发方式更为自由。我们的小册在实战篇会对单机游戏和多人游戏分别讲解。

![多人游戏](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/9/13/165d34527b380026~tplv-t2oaga2asx-image.image)

近期开放的关联跳转能力，为开发者带来一个最直接的利好，就是提升拉新能力，让流量优化。通过流量高的小游戏来带动其他小游戏的推广，共用流量，提高单个用户留存时长。甚至于在有限的代码包的限制下，为了实现复杂的玩法，可以通过小游戏互相跳转的方式，来实现一主一副的完整游戏功能。

最后要讲的玩法是基于激励视频广告的设计。广告我们在前面已经介绍过了，激励视频广告可以结合游戏场景做设计，如通关、复活、获取道具、获取积分、获取游戏机会等。

> 广告的设计切记不可阻断游戏流程，不可强制用户观看广告。

![广告](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/9/13/165d3453194e7a4b~tplv-t2oaga2asx-image.image)

除此之外，小游戏还提供了图片、语音、微信运动等诸多接口，我们也可以尝试从这些接口入手，探索更多玩法的可能性。

## 3\. 能力展望

小游戏目前已经提供了多达 30+ 的开放能力，仍有 100+ 项开放新能力正在规划中。涉及基础能力、社交/分享、玩法等。

### 真机调试

真机调试能力目前在规划中，开发者可在开发阶段的不同终端上体验游戏的流畅度，以确保最终上线的效果。

### 跳转

对于跳转能力，小游戏目前已经开放了与小程序、小游戏之间互相跳转的能力，但与 APP 的跳转仍在规划中。如若开放了 APP 间的跳转，小游戏有望与 APP 实现合作共赢。设想可以有这样一个模式：在小游戏中制作“试玩版”降低体验门槛，获得初期的曝光，培养粉丝；而 APP 游戏内的模块也可以拆分成小游戏（如：签到、抽卡等）来维持活跃。

### 动态消息卡片

分享能力和分享呈现都会进行强化：动态消息卡片能力，可以将实时状态进行呈现（如：房间当前人数、游戏开始/结束状态等）。这样一来，用户对自己点开卡片进去后是什么有了一个准确的预期。

### 消息触达

规划中的消息触达能力，可以让开发者获知游戏中有价值的场景和消息是否被用户所触达。

### 实时语音

实时语音的能力，能将语音融合到游戏中，将很好地提升游戏中的社交氛围感。

## 4\. 小结

微信小游戏提供了许多开放能力，为游戏设计提供了无限的可能性。本节提到的玩法设计只是一些常见的内容，读者可以根据小游戏的能力再不断地去扩散思维，设计一款属于自己独一无二的游戏。但小游戏本身优势仍是在社交，因此我们在设计游戏时要多从社交的角度出发，利用好平台提供的能力。

至此，我们已经对小游戏有一个比较深入的认知了。接下来，我们将专注于游戏开发本身。在下一章节，将讲解游戏的相关概念，以及现有的游戏引擎对微信小游戏的支持情况。
    