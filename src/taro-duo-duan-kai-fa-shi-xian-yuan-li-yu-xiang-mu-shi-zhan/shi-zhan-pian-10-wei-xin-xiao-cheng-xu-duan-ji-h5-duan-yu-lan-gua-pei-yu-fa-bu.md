
# 实战篇 10-微信小程序端及 H5 端预览适配与发布
---

# 微信小程序及 H5 端预览适配与发布

## 简单介绍

**Taro** 是一个多端适配的框架，可以运行在各个端。

怎么样编写一套代码适配各端呢？在 **Taro** 中其实很简单，只需要通过不同的命令就可以生成各个端的代码，具体可以查看[官方文档](https://nervjs.github.io/taro/docs/GETTING-STARTED.html)。

## 适配方案

在 Taro 中是通过 rpx 和 rem 分别适配小程序和 H5 端，在开发项目时，尺寸单位建议使用 px 和百分比， Taro 默认会对所有的单位进行转换。在小程序中 Taro 会转成 rpx ，在 H5 中默认转换成 rem。具体转换参数可以参考[官方说明](https://nervjs.github.io/taro/docs/size.html)。

## 小程序开发框架中运行与发布

在微信开发者工具中新建项目的时候，选择项目地址应选择项目中编译的 **dist** 目录。

### 小程序发布过程

- 注册账号

在微信公众平台注册微信小程序账号，分为个人和企业注册，个人注册的功能有的有限制，还无法认证。 注册完成后，会在公众平台设置一个 AppID。

![](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/10/8/16651730e321b3b0~tplv-t2oaga2asx-image.image)

- 开发代码及注意事项

注意选择目录是编译 dist。

![](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/10/8/16651730e31497ee~tplv-t2oaga2asx-image.image)

小程序前端代码在微信开发者工具，就可以上传，如下图所示：

![](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/10/8/16651730e338a8f1~tplv-t2oaga2asx-image.image)

上传后是体验版本，需要提交微信审核，审核完成就发布成功了，接下来后面两个步骤就是配置后端服务。

![](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/10/8/16651730e33255a1~tplv-t2oaga2asx-image.image)

目前小程序的审核在一小时到 N 天不等。官方说的是 7个工作日内，笔者的经历来看，也有在晚上发布，第二天早上就审核通过了。 笔者建议如果有公司则以公司申请，不要以个人身份注册小程序，很多的类目对个人未开放，限制有点多。 这里推荐一款小程序**小程序开发助手**，界面如下:

![](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2018/11/13/16708e0dd882a98e~tplv-t2oaga2asx-image.image)

这款小程序会显示你参与的所有小程序，提交的记录。 需要注意的是涉及到区块链、贷款、彩票、色情低俗、代购类的小程序基本上不会通过。总结如下：

```
- 常见被拒绝情形诱导关注、诱导分享朋友圈。
凡涉及到关注公众号、分享到朋友圈，均可能封掉相应接口。
- 虚拟支付
凡非实物销售均可列入此范围。如付费购买音视频内容、付费购买教育课程。
- 未取得腾讯授权，不可以借助其他小程序或 APP 实现自身功能。
优惠券、导购类小程序。
- 需补充社交，笔记类目。
涉及可编辑、转发的小程序，涉及用户自定义内容及分享的小程序。
- 需补充社交-社区/论坛类目。
涉及回复互动类小程序
- 需补充文娱-视频类目。
涉及在线视频观看的小程序
- 无法被搜索。
部分包含恶意或风险信息的小程序（如涉嫌混淆官方产品名称、色情低俗、欺诈等），可能不能被搜索出。
- 小程序实际所提供的服务属于尚未开放的服务类目
小程序还未开放的服务。
- 小程序服务涉及可编辑、发布内容，属个人未开放类目。
以个人为主体开发的小程序，目前限制太多，基本上只能做信息查询类小程序。
```

### 个人建议如下

- 上线前多进行测试，减少 Bug，这样就能减少提交审核的次数。
- 心态放好，不要想着别人都上线了，为啥自己的不能上，先从自己身上找原因。
- 申请小程序时，证件号码等要仔细。
- 同一时间提交的小程序，审核时间不一定一致。
- 小程序中不要出现色情等低俗内容，否则被举报后，会被暂停服务。
- 不要在提交审核的小程序中使用测试数据。
- 名称中含有特殊行业名词，若没有选择相应类目，很可能会被拒绝。如名称中有“保险”二字，会要求你提供保险行业的资质。特殊名称还有：社区。
- 不要在页面提供二维码，供用户下载 App，否则可能会被视为“诱导下载”。
- 关于企业认证中给腾讯账号小额打款，腾讯公司的小额打款账号为招商银行 25位账号，若不支持，则不要选择这种方式认证。

### H5 发布过程

- 部署腾讯云【也可用其他，无参考价值，主要是部署小程序后端】，如果是初次部署，审核周期会有点长，需要耐心，
  - 注册腾讯云
  - 腾讯云实名认证
  - 购买腾讯云产品，链接远程桌面
- 在远程桌面搭建环境，部署后台代码到远程主机。
    